# XSS (Cross-Site Scripting)

## Что такое XSS?

XSS — это тип уязвимости веб-приложений, при которой злоумышленник внедряет в страницы сайта вредоносный скрипт, который затем выполняется в браузере других пользователей. Это позволяет атакующему выполнять произвольный JavaScript код, воровать данные, совершать действия от имени пользователя и даже захватывать сессии.

## Виды XSS

- **Reflected XSS (Отражённый)**  
  Вредоносный код вставляется в URL или форму, и сразу же отражается на странице без сохранения.

- **Stored XSS (Сохраняемый)**  
  Злоумышленник сохраняет скрипт на сервере (например, в комментариях, в профиле пользователя), и он выполняется у всех посетителей.

- **DOM-based XSS**  
  Уязвимость возникает из-за небезопасной работы с DOM-элементами на клиенте, без участия сервера.

## Чем опасен XSS?

- Кража cookie и сессий пользователя.
- Перенаправление на фишинговые или вредоносные сайты.
- Внедрение кейлоггеров и других шпионских скриптов.
- Модификация содержимого страницы.
- Выполнение действий от имени жертвы.

## Пример уязвимого кода (PHP)

```php
echo "Привет, " . $_GET['name'];
```
Если в name передать скрипт:

```html
<script>alert('XSS');</script>
```

То он выполнится в браузере пользователя.

## Как защититься от XSS?

| Метод                  | Суть                                               | Примечание                      |
|------------------------|----------------------------------------------------|--------------------------------|
| Экранирование (Escaping) | Преобразование специальных символов в HTML сущности | `htmlspecialchars()` в PHP     |
| Content Security Policy (CSP) | Политика безопасности для ограничения выполнения скриптов | Уменьшает последствия атак     |
| Валидация и фильтрация | Проверка и очистка пользовательского ввода          | Использовать whitelist          |
| Использование фреймворков | Многие фреймворки автоматически экранируют вывод     | React, Angular, Vue и др.       |
| HTTP-only cookie       | Делать cookie недоступными для JS                    | Защищает сессии от кражи       |


## Пример защиты в PHP

```php
$name = htmlspecialchars($_GET['name'], ENT_QUOTES, 'UTF-8');
echo "Привет, $name";
```

## Резюме

XSS — одна из самых распространённых уязвимостей. Злоумышленник может выполнить произвольный JavaScript-код в браузере жертвы, что позволяет красть данные, перенаправлять на фишинговые сайты и выполнять нежелательные действия от имени пользователя. 

Для защиты используйте экранирование специальных символов, строгую валидацию пользовательского ввода и внедрение Content Security Policy (CSP). Не доверяйте данным от пользователя и всегда тщательно фильтруйте их перед выводом.

Минимизация прав, настройка HTTP-only cookie и применение современных фреймворков помогут снизить риск успешной атаки и уменьшить возможный ущерб.

## Полезные ссылки

- [OWASP XSS](https://owasp.org/www-community/attacks/xss/)
- [Mozilla Developer Network: Cross-site scripting (XSS)](https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting)
- [Content Security Policy (CSP) — MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)

## Важное замечание

Вся информация предоставлена исключительно в учебных целях. Используйте её для повышения безопасности, а не для нанесения вреда.
